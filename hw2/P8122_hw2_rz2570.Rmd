---
title: "P8122 Homwork 2"
author: "Roxy Zhang"
date: "9/29/2022"
output: html_document
---

```{r setup, include=FALSE}
# install ri from local file
#library(devtools)
#install_local("~/Desktop/P8122/causal_inference/hw2/ri_0.9.tar.gz")

library(ri)
library(tidyverse)
```

```{r}
# read and clean data
df = read_csv("~/Desktop/P8122/causal_inference/hw2/light.csv") %>% 
  janitor::clean_names()
```


```{r}
# plot the outcome by treatment group
ggplot(data = df, aes(x = light, y = bm_gain)) +
  geom_bar(stat = "identity")
```

```{r}
# only interested in mice exposed to darkness and bright
# subset the data into two groups
df_sub = df %>% 
  filter(light != "DM")
```


```{r}
# set up the data such that everything needed has generic names
# re-code treatment: dark as 0 and bright as 1
df_setup = df_sub %>% 
  select("light", "bm_gain") %>% 
  rename(A = light,
         Y = bm_gain) %>% 
  mutate(A = case_when(A == "LD" ~ 0,
                       A == "LL" ~ 1)) %>% 
  arrange(desc(A))
```


```{r}
# calculate the difference in means between the two treatment groups
y0 = data.frame(df_setup %>% 
                filter(A == 0) %>% 
                select(Y))

avg_y0 = mean(y0$Y)
round(avg_y0, 2)

y1 = data.frame(df_setup %>% 
                filter(A == 1) %>% 
                select(Y))

avg_y1 = mean(y1$Y)
round(avg_y1, 2)

t_obs = round(avg_y1 - avg_y0, 2)
t_obs
```

```{r}
# enumerate different possibilities for A in a matrix
Abold = genperms(df_setup$A, maxiter = 30000)

Abold[, 1:15]

ncol(Abold)
```


```{r}
```


```{r}
```


```{r}
```

